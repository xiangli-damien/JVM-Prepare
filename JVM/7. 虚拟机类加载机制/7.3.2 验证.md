
### 概述

验证阶段是连接(Linking)阶段的首步，主要目的是确保Class文件信息符合JVM规范，不会危害到JVM自身安全。

- **验证的目的和意义**

	- 确保字节码安全，防止恶意代码攻击。
	- Java语言安全性的扩展，防止字节码层面的非法操作。
	- 防止Java虚拟机加载格式不正确的字节码。

### 验证的过程

验证过程主要分为四个阶段：

1. **文件格式验证**
   - 校验字节流是否符合Class文件格式规范，是否能被当前版本的JVM处理。
   - 验证点包括魔数、版本号、常量池有效性、文件大小等。

2. **元数据验证**
   - 对字节码描述的元数据信息进行语义校验，确保符合Java语言规范。
   - 检查类是否有父类、final类的继承合法性、方法覆盖的合法性等。

3. **字节码验证**
   - *最复杂的验证阶段* ，通过数据流分析和控制流分析来保证程序逻辑合法性和安全性。
   - 包括操作数栈类型匹配、跳转指令合法性、类型转换有效性等。

4. **符号引用验证**
   - ==确保类、方法、字段的符号引用都能正确解析到具体的直接引用。==
   - 检查全限定名的类是否存在、字段和方法的名称及描述是否匹配、访问权限校验等。

## 注意事项

- 验证是一个重要但非必须执行的阶段，主要在类加载时进行，一旦通过，对运行期没有影响。
- 在已经确定安全的环境中，可以使用 `-Xverify:none` 参数来关闭验证减少类加载时间。
