
#### 对象优先在Eden分配

- **主要策略**：大多数情况下，对象首先在新生代的Eden区分配。当Eden区没有足够的空间进行分配时，虚拟机会触发一次Minor GC。
- **参数配置**：
    - `-XX:+PrintGCDetails`：打印GC详情。
    - `-Xms20M -Xmx20M -Xmn10M`：限制Java堆大小为20MB，10MB分配给新生代，剩余给老年代。
    - `-XX:SurvivorRatio=8`：Eden区与一个Survivor区的空间比例是8:1。

#### 大对象直接进入老年代

- **定义与影响**：大对象是指需要大量连续内存空间的Java对象，例如很长的字符串或大数组。大对象在内存分配时容易触发垃圾收集，以获得足够的连续空间。
- **策略**：通过设置`-XX:PretenureSizeThreshold`参数，可以使得大于此设置值的对象直接在老年代分配，避免在Eden及两个Survivor区之间的频繁复制。

#### 长期存活的对象将进入老年代

- **年龄计数器**：虚拟机给每个对象定义了一个*年龄计数器* ，对象在Survivor区每熬过一次Minor GC，年龄就增加1岁。
- **晋升老年代条件**：当对象的年龄增加到一定程度（*默认为15岁* ）时，就会被晋升到老年代中，通过`-XX:MaxTenuringThreshold`参数设置年龄阈值。

#### 动态对象年龄判定

- **策略**：如果在Survivor空间中==相同年龄所有对象大小的总和大于Survivor空间的一半==，年龄大于或等于该年龄的对象就可以直接进入老年代，无须等到`-XX:MaxTenuringThreshold`中要求的年龄。

#### 空间分配担保

- **检查条件**：在发生Minor GC之前，虚拟机会检查==老年代最大可用的连续空间是否大于新生代所有对象总空间==。
- **担保失败处理**：
    - 如果老年代最大可用连续空间小于新生代对象总大小，则检查`-XX:HandlePromotionFailure`设置。
    - 如果设置允许担保失败，则进一步检查老年代最大可用连续空间是否大于历次晋升到老年代对象的平均大小。如果条件满足，尝试进行Minor GC；否则进行Full GC。

- **JDK 6 Update 24变化**：此参数不再影响虚拟机的空间分配担保策略，改为仅当老年代连续空间大于新生代对象总大小或历次晋升平均大小时，进行Minor GC；否则进行Full GC。